<style>
html {
  scroll-behavior: smooth!important;
}
</style>

TorchServe - —ç—Ç–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º –¥–ª—è —Å–µ—Ä–≤–∏–Ω–≥–∞ PyTorch –º–æ–¥–µ–ª–µ–π. –î–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ—Å—Ç–æ–π –º–æ–¥–µ–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–µ-–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞ –∏ –ø–æ—Å—Ç-–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞.

–î–µ—Ç–∞–ª—å–Ω–µ–µ –ø—Ä–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å –≤ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://pytorch.org/serve/)

### **–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ**
1. [–ë—ã—Å—Ç—Ä–æ–µ –Ω–∞—á–∞–ª–æ (Windows)](#fast-windows)
2. [–ê—Ä—Ö–∏–≤–∏—Ä—É–µ–º –º–æ–¥–µ–ª—å](#archive-model)
   1. [–ö–∞–∫ Torchserve –≤–∏–¥–∏—Ç –º–æ–¥–µ–ª–∏](#how-torch-serve)
   2. [handler (–æ–±—Ä–∞–±–æ—Ç—á–∏–∫)](#handler)
   3. [–ü–∏—à–µ–º —Å–≤–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫](#our-handler)
   4. [–£—Ç–∏–ª–∏–∞ torch-model-archiver](#torch-model-archiver)
3. [Docker](#docker)

<br>

---

<br>

## <a id="fast-windows"></a>üöÄ –ë—ã—Å—Ç—Ä–æ–µ –Ω–∞—á–∞–ª–æ (Windows)


### **–ó–∞–±—Ä–∞—Ç—å [—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å Torchserve](https://github.com/Aleksey512/Torchserve)**

* –° –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

```shell
git clone https://github.com/Aleksey512/Torchserve.git

# –ò–ª–∏ –µ—Å–ª–∏ –µ—Å—Ç—å SSH –∫–ª—é—á

git clone git@github.com:Aleksey512/Torchserve.git 
```
 
* –° –ø–æ–º–æ—â—å—é IDE (–ù–∞ –ø—Ä–∏–º–µ—Ä–µ [PyCharm](https://www.jetbrains.com/ru-ru/pycharm/))
 
![Photo](img/screenIDE.png)

### **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å [Docker](https://www.docker.com/)**

–î–ª—è –Ω–µ–≥–æ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å wsl2
 
–î–ª—è —ç—Ç–æ–≥–æ –æ—Ç–∫—Ä—ã–≤–∞–º PowerShell —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏ –≤—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—É

 ```shell
 wsl --install
```

–ü–æ–¥—Ä–æ–±–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ–ø–∏—Å–∞–Ω –Ω–∞ —Å–∞–π—Ç–µ [Microsoft](https://docs.microsoft.com/ru-ru/windows/wsl/install-win10), —Ç–∞–º –∂–µ —É–∫–∞–∑–∞–Ω—ã –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è.

–î–∞–ª–µ–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–∞–º **[Docker](https://www.docker.com/)**, —Å–ª–µ–¥—É—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–∞ —Å–∞–π—Ç–µ

### **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞**

<a if="mymodel"></a>[–°–∫–∞—á–∏–≤–∞–µ–º](https://www.kaggle.com/datasets/boliu0/melanoma-winning-models) –∏ –ø–æ–º–µ—â–∞–µ–º –Ω–∞—à—É –º–æ–¥–µ–ª—å (***9c_b7ns_1e_640_ext_15ep.pth***)
–≤ –ø–∞–ø–∫—É ***model_dir*** –∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º –º–æ–¥–µ–ª—å –≤ ***model.pth***

### **–ó–∞–ø—É—Å–∫**

1. –ó–∞–ø—É—Å–∫–∞–µ–º DockerDesktop ![DockerDesktop](img/DockerDesktop.png)
2. –ó–∞–ø—É—Å–∫–∞–µ–º PowerShell
3. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É —Å –ø—Ä–æ–µ–∫—Ç–æ–º
    ```shell
    cd –ø—É—Ç—å/–¥–æ/–ø–∞–ø–∫–∏/
    ```
4. –í—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—É
    ```
    docker compose up --build   
   ```
   
### üòä **–ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω**

–ß—Ç–æ –±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫–∞–∫–∏–µ –º–æ–¥–µ–ª–∏ —É –Ω–∞—Å –µ—Å—Ç—å, –≤ —Å—Ç—Ä–æ–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞–±–µ—Ä–∏—Ç–µ:

```djangourlpath
http://localhost:8081/models
```
–ü—Ä–∏–º–µ—Ä–Ω—ã–π –≤—ã–≤–æ–¥:
```JSON
{
   "model_name": "model", 
   "model_url": "model.pth"
}
```

–î–ª—è —Ç–æ–≥–æ —á—Ç–æ –±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –Ω–∞—à—É –º–æ–¥–µ–ª—å, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å POST –∑–∞–ø—Ä–æ—Å, –∏ –≤ body —É–∫–∞–∑–∞—Ç—å —Ñ–ª–∞–≥ **file** = photo.jpg –ø–æ –∞–¥—Ä–µ—Å—Å—É:
```djangourlpath
http://localhost:8080/predictions/–ò–ú–Ø_–ú–û–î–ï–õ–ò
```

–ü—Ä–∏–º–µ—Ä–Ω—ã–π –≤—ã–≤–æ–¥:

```JSON
{
  "melanoma": 0.91493821144104,
  "nevus": 0.005232867784798145
}
```

–≠—Ç–æ—Ç —Ñ–ª–∞–≥, –∫–∞–∫ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–µ, –ø–æ–ª—É—á–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –≤ —Ñ–∞–π–ª–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –º–æ–¥–µ–ª–∏ (***handler.py***)

<br>

---

<br>

## <a id="archive-model"></a> üöÄ –ê—Ä—Ö–∏–≤–∏—Ä—É–µ–º –º–æ–¥–µ–ª—å

### <a id="how-torch-serve"></a> **–ö–∞–∫ TorchServe –≤–∏–¥–∏—Ç –º–æ–¥–µ–ª–∏**

TorchServe —Ç—Ä–µ–±—É–µ—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –≤ —Å–≤–æ–π —Ñ–æ—Ä–º–∞—Ç. –î–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ø—Ä–µ–¥—Å—Ç–æ–≤–∞–ª—è–µ—Ç –∏–∑ —Å–µ–±—è –∞—Ä—Ö–∏–≤ –≤–∏–¥–∞ *.mar. –í–Ω—É—Ç—Ä–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –µ—Å—Ç—å –≤—Å–µ –¥–ª—è —É—Å–ø–µ—à–Ω–æ–π —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏. 

–î–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ –º–æ–¥–µ–ª–∏ –≤ –∞—Ä—Ö–∏–≤, –µ—Å—Ç—å —É—Ç–∏–ª–∏—Ç–∞ **torch-model-archiver**

–î–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –Ω–∞–º –Ω—É–∂–Ω–æ:

* –ú–æ–¥–µ–ª—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ TorchServe/Onnx/–¥—Ä.;

* –°–∫—Ä–∏–ø—Ç, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–π –ø–∞–π–ø–ª–∞–π–Ω —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏.

–¢–∞–∫–æ–π —Å–∫—Ä–∏–ø—Ç –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è handler. –í –Ω–µ–º –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –º–æ–¥–µ–ª–∏ (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ, –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –¥—Ä.). 

### <a id="handler"></a> **Handler**

–°–∞–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π *.py —Ñ–∞–π–ª, —Å –∫–ª–∞—Å—Å–æ–º [–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞](https://pytorch.org/serve/custom_service.html#custom-handler-with-class-level-entry-point).
–î–ª—è —Ç–∏–ø–æ–≤—ã—Ö –∑–∞–¥–∞—á –æ–Ω–∏ —É–∂–µ [–ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã](https://pytorch.org/serve/#default-handlers).

–†–∞–∑–±–µ—Ä–µ–º –∏–∑ —á–µ–≥–æ —Å–æ—Å—Ç–æ–∏—Ç —Ñ–∞–π–ª handler –¥–ª—è –Ω–∞—à–µ–π [–º–æ–¥–µ–ª–∏](#mymodel)

<a id="our-handler"></a>

–ò–º–ø–æ—Ä—Ç—ã –≤—ã–≥–ª—è–¥—è—Ç —Ç–∞–∫:
```python
# Input/Output
import io

# –°–∞–º —Ç–æ—Ä—á, –ª–æ–≥–∏, –¥–æ—Å—Ç—É–ø –∫ –û–°
import torch
import logging
import os

# Pillow, torcvision –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º
from PIL import Image
from torchvision import transforms

# –ö–ª–∞—Å—Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
from ts.torch_handler.base_handler import BaseHandler

# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏
from model import enetv2
```

–ö–ª–∞—Å—Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–∞–∫ –≥–æ–≤–æ—Ä–∏–ª–æ—Å—å –≤—ã—à–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏, –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏, –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è, –ø–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –¥—Ä.

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:
```python
class ModelHandler(BaseHandler):
    
    def initialize(self, context):
        """–ö–ª–∞—Å—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        Args:
            context (context): –≠—Ç–æ –æ–±—ä–µ–∫—Ç JSON, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é 
            –æ—Ç–Ω–æ—Å—è—â—É—é—Å—è –∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –º–æ–¥–µ–ª–∏
        """

        properties = context.system_properties
        self.manifest = context.manifest # –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å

        logger.info(f'Properties: {properties}') 
        logger.info(f'Manifest: {self.manifest}')

        self.device = torch.device('cpu')
        
        model_file = self.manifest["model"].get("modelFile", "") # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª –º–æ–¥–µ–ª–∏

        if model_file: # –ï—Å–ª–∏ —Ñ–∞–π–ª –º–æ–¥–µ–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
            self.model = enetv2(enet_type, n_meta_features=0, out_dim=out_dim) # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏
            self.model = self.model.to(self.device) # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –Ω–∞ –¥–µ–≤–∞–π—Å (gpu/cpu)
            
            # –ó–∞–≥—Ä—É–∑–∫–∞ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏
            state_dict = torch.load(model_file, map_location=self.device)
            state_dict = {k.replace('module.', ''): state_dict[k] for k in state_dict.keys()}
            self.model.load_state_dict(state_dict, strict=True)
            
            # –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤ —Ä–µ–∂–∏–º –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–Ω–∏—è (–±–µ–∑ —Ä–∞—Å—á—ë—Ç–∞ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞)
            self.model.eval()
            
            logger.info(f'Successfully loaded model from {model_file}')
        else:
            raise RuntimeError('Missing the model file')

        self.initialized = True # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–æ–¥–µ–ª—å
```

–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö:
```python
    def preprocess(self, requests):

        data = requests[0] # –ó–∞–±–∏—Ä–∞–µ–º —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞

        photo = data['file'] # –ò—â–µ–º {"file" : –¥–∞–Ω–Ω—ã–µ}
        
        logger.info(f'Received photo') # –í—ã–≤–æ–¥–∏–º –ª–æ–≥–∏
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        my_transforms = transforms.Compose([transforms.Resize(640),
                                            transforms.CenterCrop(640),
                                            transforms.ToTensor(),
                                            transforms.Normalize(
                                                [0.485, 0.456, 0.406],
                                                [0.229, 0.224, 0.225])])
        image = Image.open(io.BytesIO(photo))
        
        return my_transforms(image) # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
```

–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ: 
```python
    def inference(self, inputs):
        outputs = self.model(inputs.unsqueeze(0).to(self.device)) # –û—Ç–¥–∞–µ–º –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å preprocess
        probabilities = outputs.softmax(1) # –ü–æ–ª—É—á–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
        mel_prob, nv_prob = probabilities.data[0][6], probabilities.data[0][7]
        logger.info('Predictions successfully created.')

        return mel_prob.item(), nv_prob.item() # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
```

–ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞:
```python
    def postprocess(self, outputs):
        predictions = {'melanoma': outputs[0], 'nevus': outputs[1]}
        logger.info(f'PREDICTED LABELS: {predictions}')

        return [predictions] # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ, –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ—Ç–ø—Ä–∞–≤–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ –≤–∏–¥–µ JSON
```

### <a id="torch-model-archiver"></a> **–£—Ç–∏–ª–∏—Ç–∞ torch-model-archiver**

–ö–ª—é—á–µ–≤–æ–π –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å—é TorchServe —è–≤–ª—è–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–ø–∞–∫–æ–≤–∫–∏ –≤—Å–µ—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –º–æ–¥–µ–ª–∏ –≤ –µ–¥–∏–Ω—ã–π –∞—Ä—Ö–∏–≤–Ω—ã–π —Ñ–∞–π–ª –º–æ–¥–µ–ª–∏. 
–≠—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (CLI), –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –≤–∑—è—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –º–æ–¥–µ–ª–∏ –∏–ª–∏ —Ñ–∞–π–ª –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –∏ —É–ø–∞–∫–æ–≤–∞—Ç—å –∏—Ö –≤ —Ñ–∞–π–ª *.mar. 

#### ***–£—Å—Ç–∞–Ω–æ–≤–∫–∞***

```shell
pip install torch-model-archiver
```

#### ***–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å torch-model-archiver***

```shell
torch-model-archiver --model-name model --version 1.0 --model-file examples/model.py --serialized-file model.pth --extra-files examples/index_to_name.json --handler image_classifier
```

#### ***–ê—Ä–≥—É–º–µ–Ω—Ç—ã***

```
$ torch-model-archiver -h
usage: torch-model-archiver [-h] --model-name MODEL_NAME  --version MODEL_VERSION_NUMBER
                      --model-file MODEL_FILE_PATH --serialized-file MODEL_SERIALIZED_PATH
                      --handler HANDLER [--runtime {python,python3}]
                      [--export-path EXPORT_PATH] [-f] [--requirements-file] [--config-file]

optional arguments:
  -h, --help            –ü–æ–º–æ—â—å
  --model-name MODEL_NAME
                        –ò–º—è —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º–æ–π –º–æ–¥–µ–ª–∏. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –±—É–¥–µ—Ç –Ω–∞–∑–≤–∞–Ω –∫–∞–∫
                        model-name.mar –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ç–µ–∫—É—â–µ–º —Ä–∞–±–æ—á–µ–º –∫–∞—Ç–∞–ª–æ–≥–µ
                        –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ --export-path, –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –æ–Ω –±—É–¥–µ—Ç
                        —Å–æ—Ö—Ä–∞–Ω–µ–Ω –ø–æ –ø—É—Ç–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞
  --serialized-file SERIALIZED_FILE
                        –ü—É—Ç—å –∫ .pt –∏–ª–∏ .pth —Ñ–∞–π–ª—É, —Å–æ–¥–µ—Ä–∂–∞—â–µ–º—É –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏.
  --model-file MODEL_FILE
                        –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É *.py, —Å–æ–¥–µ—Ä–∂–∞—â–µ–º—É –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –º–æ–¥–µ–ª–∏.
                        –§–∞–π–ª –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–∏ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ
                        –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –∏–∑ torch.nn.Module.
  --handler HANDLER     
                        –ò–º—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ TorchServe –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–ª–∏ –ø—É—Ç—å –∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫—É *.py
                        –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –ª–æ–≥–∏–∫–∏ –≤—ã–≤–æ–¥–∞ TorchServe.
  --extra-files EXTRA_FILES
                        –ü—É—Ç—å –∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º —Ñ–∞–π–ª–∞–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–æ–¥–µ–ª–∏ (—Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è –∑–∞–ø—è—Ç–æ–π)
  --runtime {python,python3}
                        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞ –∫–∞–∫–æ–º —è–∑—ã–∫–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤–∞—à
                        –∫–æ–¥ –≤—ã–≤–æ–¥–æ–≤. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
                        RuntimeType.PYTHON.
  --export-path EXPORT_PATH
                        –ü—É—Ç—å –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –∞—Ä—Ö–∏–≤ *.mar
  --archive-format {tgz, no-archive, zip-store, default}
                        –§–æ—Ä–º–∞—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –∞—Ä—Ö–∏–≤–∏—Ä—É—é—Ç—Å—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –º–æ–¥–µ–ª–∏.
                        "tgz": –°–æ–∑–¥–∞–µ—Ç –∞—Ä—Ö–∏–≤ –º–æ–¥–µ–ª–µ–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ <–∏–º—è –º–æ–¥–µ–ª–∏>.tar.gz.
                        –ï—Å–ª–∏ —Ö–æ—Å—Ç–∏–Ω–≥ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –º–æ–¥–µ–ª–∏ –±—ã–ª–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ ".tar.gz"
                        –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É –æ–ø—Ü–∏—é.
                        "no-archive": –≠—Ç–∞ –æ–ø—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç –Ω–µ–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –º–æ–¥–µ–ª–∏
                        –ø–æ –∞–¥—Ä–µ—Å—É "export-path/{model-name}". –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —ç—Ç–æ–≥–æ –≤—ã–±–æ—Ä–∞,
                        —Ñ–∞–π–ª MANIFEST –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –≤ –º–µ—Å—Ç–µ "export-path/{model-name}".
                        –±–µ–∑ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è —ç—Ç–∏—Ö —Ñ–∞–π–ª–æ–≤ –º–æ–¥–µ–ª–∏
                        "zip-store": –≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –∞—Ä—Ö–∏–≤ –º–æ–¥–µ–ª–µ–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ <–∏–º—è –º–æ–¥–µ–ª–∏>.mar
                        –Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç —Å–∂–∞—Ç–∏–µ —Ñ–∞–π–ª–æ–≤ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∏—è. –í –æ—Å–Ω–æ–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
                        –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                        "default": –°–æ–∑–¥–∞–µ—Ç –º–æ–¥–µ–ª—å-–∞—Ä—Ö–∏–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ <–∏–º—è –º–æ–¥–µ–ª–∏>.mar.
                        –≠—Ç–æ —Ñ–æ—Ä–º–∞—Ç –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –ú–æ–¥–µ–ª–∏, –∑–∞–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ —ç—Ç–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
                        –±—É–¥—É—Ç –ª–µ–≥–∫–æ —Ä–∞–∑–º–µ—â–∞—Ç—å—Å—è –Ω–∞ TorchServe.
  -f, --force           
                        –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω —Ñ–ª–∞–≥ -f –∏–ª–∏ --force, —Ç–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ñ–∞–π–ª–∞ .mar –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
                        .mar —Ñ–∞–π–ª —Å —Ç–µ–º –∂–µ –∏–º–µ–Ω–µ–º, —á—Ç–æ —É–∫–∞–∑–∞–Ω–æ –≤ --model-name
  -v, --version         
                        –í–µ—Ä—Å–∏—è –º–æ–¥–µ–ª–∏
  -r, --requirements-file
                        –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É requirements.txt, —Å–æ–¥–µ—Ä–∂–∞—â–µ–º—É —Å–ø–∏—Å–æ–∫ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –¥–ª—è –º–æ–¥–µ–ª–∏ –ø–∞–∫–µ—Ç–æ–≤ python
                        –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã TorchServe –¥–ª—è –±–µ—Å–ø–µ—Ä–µ–±–æ–π–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –º–æ–¥–µ–ª—è–º–∏.
  -c, --config-file     –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –º–æ–¥–µ–ª–∏ *.yaml 
```

–ü–æ–¥—Ä–æ–±–Ω–µ–µ –≤ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://github.com/pytorch/serve/blob/master/model-archiver/README.md)

<br>

---

<br>

## <a id="docker"></a> üöÄ Docker

Docker ‚Äî —ç—Ç–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö.

–ù–µ –±—É–¥—É —Å–∏–ª—å–Ω–æ –≤–¥–∞–≤–∞—Ç—å—Å—è –≤ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏, —á—Ç–æ —Ç–∞–∫–æ–µ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –∏ –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è. –†–∞–∑–±–µ—Ä—É –ø—Ä–∏–º–µ—Ä—ã –Ω–∞ Docker —Ñ–∞–π–ª–µ –∏ Docker compose –¥–ª—è –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏

#### ***Docker***

–ß—Ç–æ –∏–∑ —Å–µ–±—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç Docker —Ñ–∞–π–ª:

```dockerfile
# image —Å –∫–æ—Ç—Ä–æ–≥–æ –º—ã –±—É–¥–µ–º –±—Ä–∞—Ç—å –æ—Å–Ω–æ–≤—É –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
FROM pytorch/torchserve:latest

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
RUN pip3 install transformers Pillow torchvision geffnet

# –ö–æ–ø–∏—Ä—É–µ–º –Ω–∞—à –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥, –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä 
COPY config.properties /home/model-server/config.properties

# –ö–æ–ø–∏—Ä—É–µ–º –Ω–∞—à—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å –º–æ–¥–µ–ª—è–º–∏ *.pth/*.pt, –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä 
COPY model_dir /home/model-server/model_dir/

# –î–∞–ª—å—à–µ —è —Ä–µ—à–∏–ª –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª–∏ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
# —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∏ –Ω–µ –¥–µ–ª–∞—Ç—å, –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª–∏
# –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ, –∏ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∏—Ö —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã COPY
# –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

# –ö–æ–ø–∏—Ä—É–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏, –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä 
COPY handler.py /home/model-server/handler.py
COPY model.py /home/model-server/model.py

# –ê—Ä—Ö–∏–≤–∏—Ä—É–µ–º –º–æ–¥–µ–ª—å
RUN torch-model-archiver --model-name model  \
    --version 1.0  \
    --model-file model_dir/model.pth  \
    --handler handler.py  \
    --extra-files "model.py"  \
    --export-path model-store
```

–Ø —Ä–µ—à–∏–ª –ø—Ä–∏–º–µ–Ω–∏—Ç—å –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—é –≤ –≤–∏–¥–µ docker compose, k8s –º–Ω–µ –ø–æ–∫–∞–∑–∞–ª–æ—Å—å –Ω–µ—É–º–µ—Å—Ç–Ω–æ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å –¥–ª—è —Ç–∞–∫–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

Docker Compose ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ, –≤—Ö–æ–¥—è—â–µ–µ –≤ —Å–æ—Å—Ç–∞–≤ Docker. –û–Ω–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–æ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ–º –ø—Ä–æ–µ–∫—Ç–æ–≤.
–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è Docker Compose, –µ—Å–ª–∏ –æ–ø–∏—Å—ã–≤–∞—Ç—å –µ—ë —É–ø—Ä–æ—â—ë–Ω–Ω–æ, –ø–æ–∑–≤–æ–ª—è–µ—Ç, —Å –ø–æ–º–æ—â—å—é –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã, –∑–∞–ø—É—Å–∫–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–∏—Å–æ–≤.

#### ***–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Docker –∏ Docker Compose***

Docker –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ (—Å–µ—Ä–≤–∏—Å–∞–º–∏), –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ—Å—Ç–æ–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

Docker Compose –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏, –≤—Ö–æ–¥—è—â–∏–º–∏ –≤ —Å–æ—Å—Ç–∞–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ç–µ –∂–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, —á—Ç–æ –∏ Docker, –Ω–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏.

![DockerVsDockercompose](img/docker-compose.png)

–†–∞–∑–±–µ—Ä–µ–º docker compose —Ñ–∞–π–ª:

```yaml
# –í–µ—Ä—Å–∏—è docker compose
version: '3.9'

# –°–µ—Ä–≤–∏—Å—ã
services:
   
  # –°–µ—Ä–≤–∏—Å TorchServe (–æ—Å–Ω–æ–≤–∞)
  torchserve:
    # –í –æ–ø—Ü–∏–∏ build —É–∫–∞–∑—ã–≤–∞–µ–º dockerfile/image –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –æ—Å–Ω–æ–≤–æ–π
    build:
      dockerfile: ./Dockerfile
    # –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
    command: torchserve --start --model-store model-store --models all --ts-config /home/model-server/config.properties --ncs
    # –ü–æ—Ä—Ç—ã –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç–∫—Ä—ã—Ç—å
    expose:
      - 8080
      - 8081
      - 8082
    
    # –ï—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É —Å –Ω–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (–Ω–∞—Ö–æ–¥—è—Å—å –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞),
    # –º—ã –¥–æ–ª–∂–Ω—ã –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –ø–æ—Ä—Ç–∞ –Ω–∞ –ø–æ—Ä—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä–∞.
    # –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: [–ø–æ—Ä—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä–∞]:[–ø–æ—Ä—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞]
    ports:
      - "8080:8080"
      - "8081:8081"
      - "8082:8082"
  
  # –°–µ—Ä–≤–∏—Å –¥–ª—è –º–µ—Ç—Ä–∏–∫–∏
  prometheus:
    image: prom/prometheus
    expose:
      - 9090
    ports:
      - "9090:9090"
    # –ü–µ—Ä–µ–¥–∞–µ–º –≤ –Ω–∞—à –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ñ–∞–π–ª —Å –∫–æ–Ω—Ñ–∏–≥–æ–º –¥–ª—è Prometeus 
    # –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: [–§–∞–π–ª/–ø–∞–ø–∫–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞]:[–§–∞–π–ª/–ø–∞–ø–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞]
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
    # –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ 'depends_on' –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å, –¥–æ–ª–∂–µ–Ω –ª–∏ —Å–µ—Ä–≤–∏—Å,
    # –ø—Ä–µ–∂–¥–µ —á–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è, –∂–¥–∞—Ç—å, –∫–æ–≥–¥–∞ –±—É–¥—É—Ç –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã.
    # –ù–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã —Å–µ—Ä–≤–∏—Å 'prometheus' –¥–æ–∂–¥–∞–ª—Å—è –±—ã –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —Ä–∞–±–æ—Ç–µ —Å–µ—Ä–≤–∏—Å–∞ 'torchserve'.
    depends_on:
      - torchserve
```